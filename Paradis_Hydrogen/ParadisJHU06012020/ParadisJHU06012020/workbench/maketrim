# Declaration of variables
CC = mpicxx
EZMATH_DIR = ../ezmath/
CASFEM_DIR = ../CASFEM/
DISLOCATION_DIR = ../dislocation_base/
FLAGS = -I$(EZMATH_DIR) -I$(DISLOCATION_DIR) -I$(CASFEM_DIR) -DPARALLEL -vec_report0
OPTIMIZATION = -O2
EXEC = trim


EZMATH_SOURCES = AxisAlignedBoundingBox.cpp	\
	MathServices.cpp			\
	Matrix.cpp				\
	CartesianOrthogonalCoordinateSystem.cpp	\
	Patch.cpp				\
	Plane.cpp				\
	Point.cpp				\
	PointPopulatedAxisAlignedBoundingBox.cpp\
	QuadPatch.cpp				\
	Randomizer.cpp				\
	Segment.cpp				\
	GenericNode.cpp				\
	Tools.cpp				\
	TriPatch.cpp				\
	Line.cpp				\
	Vector.cpp				\
	Dodecahedron.cpp			\
	SparseMatrix.cpp			\
	Geometry.cpp				\
	Block.cpp				\
	Cylinder.cpp				\
	GeometricComponent.cpp			\
	Edge.cpp				\
	Face.cpp				\
	PolyhedronFace.cpp			\
	Polyhedron.cpp				\
	Curve.cpp


DISLOCATION_SOURCES = DislocationNode.cpp \
			DislocationSegment.cpp \
			DislocationChain.cpp \
			SurfaceSegment.cpp \
			PrecipitateStructure.cpp

SOURCES = TrimPrecip.cpp


ABSOLUTE_EZMATH_SOURCES = $(foreach source,$(EZMATH_SOURCES),$(EZMATH_DIR)$(source))
EZMATH_OBJECTS = $(ABSOLUTE_EZMATH_SOURCES:.cpp=.o)
ABSOLUTE_DISLOCATION_SOURCES = $(foreach source,$(DISLOCATION_SOURCES),$(DISLOCATION_DIR)$(source))
DISLOCATION_OBJECTS = $(ABSOLUTE_DISLOCATION_SOURCES:.cpp=.o)
OBJECTS = $(SOURCES:.cpp=.o)


# Main target
$(EXEC): $(EZMATH_OBJECTS) $(DISLOCATION_OBJECTS) $(OBJECTS)
	$(CC) $(EZMATH_OBJECTS) $(DISLOCATION_OBJECTS) $(OBJECTS) -o $(EXEC)

# To obtain object files
%.o: %.cpp
	$(CC) -c $(FLAGS) $(OPTIMIZATION) $< -o $@


# To remove generated files
clean:
	rm -f $(EXEC) ./*.o





